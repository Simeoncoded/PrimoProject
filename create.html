<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CrossFire - Create NCR</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <div class="content">
        <button type="button" class="btn btn-danger btn-floating btn-lg" id="btn-back-to-top">
            <i class="fas fa-arrow-up"></i>
        </button>

        <nav class="navbar navbar-expand-lg navsty">
            <div class="container-fluid">
                <a class="navbar-brand" href="index.html">
                    <img src="assets/images/crlogo.png" alt="Crossfire Logo" width="120">
                </a>
                <div class="collapse navbar-collapse" id="navbarNavDropdown">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="index.html">Dashboard</a>
                        </li>
                        <li>
                            <a class="nav-link" href="ncrlog.html">NCR LOG</a>
                        </li>
                        <li class="nav-item sl">
                            <a class="nav-link" href="create.html">Create NCR </a>
                        </li>
                        <li class="nav-item dropdown sr hh" id="notificationLink">
                            <a class="nav-link dropdown-toggle" href="#" id="notificationDropdown" role="button"
                                data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fa fa-bell" aria-hidden="true"></i>
                                <span id="notification-counter" class="badge bg-danger">3</span>
                            </a>

                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="notificationDropdown"
                                id="notificationList">
                            </ul>
                        </li>
                        <li class="nav-item hh">
                            <a class="nav-link" href="login.html">
                                <i class="fa-solid fa-user"></i>
                            </a>
                        </li>
                        <li class="nav-item hh" id="emailLink">
                            <a class="nav-link" href="email.html">
                                <i class="fa-solid fa-envelope"></i>
                                <span id="email-counter" class="badge bg-danger">0</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="report.html">Report</a>
                        </li>
                        <button id="logoutButton">Logout</button>

                        <!-- <button id="clearStorageBtn">Clear storage</button> -->
                    </ul>
                </div>

                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false"
                    aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon">+</span>
                </button>
            </div>
        </nav>


        <!-- Main Content -->
        <main class="container my-5" id="main-content" tabindex="-1">
            <h2 class="mb-4 text-center">Non-Conformance Report(NCR)</h2>
            <p style="text-align: center;font-weight: bold;">All fields with * (astericks) are required </p>
            <form id="ncrForm">

                <div class="row ">
                    <!-- NCR No. -->
                    <div class="col-12 col-md-6 mb-3">
                        <label for="ncr_no" class="form-label">NCR No.*</label>
                        <input type="text" class="form-control" id="ncr_no" name="ncr_no" aria-required="true"
                            placeholder="Enter NCR Number">
                        <span id="ncrNoError" class="text-danger" style="display: none; font-size: 0.9em;">NCR No. is
                            required.</span>
                    </div>

                    <!-- Date -->
                    <div class="col-12 col-md-6 mb-3">
                        <label for="date" class="form-label">Date*</label>
                        <input type="date" class="form-control" id="date" name="date" aria-required="true">
                        <span id="dateError" class="text-danger" style="display: none; font-size: 0.9em;">Date is
                            required</span>
                        <span id="dateYearError" style="display: none; color: red; font-size: 0.9em;">Please select a
                            valid
                            date in the current year.</span>
                    </div>
                </div>
                <div class="row">
                    <!-- Identify Process Applicable -->
                    <div class="col-12 col-md-6 mb-3">
                        <fieldset>
                            <legend class="form-label fw-bold">Identify Process Applicable:*</legend>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" id="supplier" name="process"
                                    value="Supplier or Rec-Insp">
                                <label class="form-check-label" for="supplier">Supplier or Rec-Insp</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" id="wip" name="process" value="WIP">
                                <label class="form-check-label" for="wip">WIP (Production Order)</label>
                            </div>
                        </fieldset>
                        <span id="identifyError" class="text-danger" style="display: none; font-size: 0.9em;">Please
                            select one of the radio buttons</span>
                    </div>


                    <!-- Supplier Name -->
                    <div class="col-12 col-md-6 mb-3">
                        <label for="supplier_name" class="form-label">Supplier Name*</label>

                        <button id="openModalBtn" class="btnSub">Add Supplier</button>
                        <span id="supplierError" class="text-danger" style="display: none; font-size: 0.9em;">Please
                            Pick a
                            Supplier</span>
                        <select class="form-control" id="supplier_name" name="supplier_name" aria-required="true">
                            <option value="">Select a supplier</option>
                            <option value="acme_supplies">Acme Supplies</option>
                            <option value="green_goods">Green Goods Ltd.</option>
                            <option value="fast_track">Fast Track Supplies</option>
                            <option value="prime_sources">Prime Sources Inc.</option>
                            <option value="blue_ocean">Blue Ocean Trading</option>
                            <option value="world_wide">World Wide Distributors</option>
                            <option value="eco_trade">Eco Trade Partners</option>
                            <option value="luxury_goods">Luxury Goods International</option>
                            <option value="mega_supplies">Mega Supplies Co.</option>
                            <option value="top_choice">Top Choice Suppliers</option>
                        </select>
                        <span id="supplierError" class="text-danger" style="display: none; font-size: 0.9em;">Pick a
                            Supplier</span>
                    </div>

                </div>



                <div class="row">
                    <!-- PO or Prod. No. -->
                    <div class="col-12 col-md-6 mb-3">
                        <label for="po_prod_no" class="form-label">PO or Prod. No.*</label>
                        <input type="number" class="form-control" id="po_prod_no" name="po_prod_no" aria-required="true"
                            placeholder="Enter product Number">
                        <span id="prodError" class="text-danger" style="display: none; font-size: 0.9em;">Prod. No is
                            required</span>
                    </div>

                    <!-- Sales Order No. -->
                    <div class="col-12 col-md-6 mb-3">
                        <label for="sales_order_no" class="form-label">Sales Order No.*</label>
                        <input type="number" class="form-control" id="sales_order_no" name="sales_order_no"
                            aria-required="true" placeholder="Enter sales order number">
                        <span id="salesError" class="text-danger" style="display: none; font-size: 0.9em;">Sales Order
                            No.
                            is required</span>
                    </div>
                </div>


                <div class="row">
                    <!-- Description of Item -->
                    <div class="col-12 col-md-6 mb-3">
                        <label for="item_description" class="form-label">
                            Description of Item (including SAP No.)
                            <span class="tooltip-icon" data-bs-toggle="tooltip" data-bs-placement="top"
                                title="SAP stands for Systems, Applications, and Products in Data Processing, a software system used for managing business operations and customer relations."><i
                                    class="fa-solid fa-eye"></i></span>
                        </label>
                        <textarea class="form-control" id="item_description" name="item_description" rows="3"
                            aria-required="true" placeholder="Enter the description of the item"></textarea>
                        <span id="desItemError" class="text-danger" style="display: none; font-size: 0.9em;">Please fill
                            out
                            Description of Item</span>
                    </div>

                    <!-- Description of Defect -->
                    <div class="col-12 col-md-6 mb-3">
                        <label for="defect_description" class="form-label">Description of Defect (in as much detail as
                            possible)</label>
                        <textarea class="form-control" id="defect_description" name="defect_description" rows="3"
                            aria-required="true" placeholder="Enter the description of all defects"></textarea>
                        <span id="desDefectError" class="text-danger" style="display: none; font-size: 0.9em;">Please
                            fill
                            out Description of Defect</span>
                    </div>
                </div>





                <div class="row">
                    <!-- Quantity Received -->
                    <div class="col-12 col-md-6 mb-3">
                        <label for="quantity_received" class="form-label">Quantity Received*</label>
                        <input type="number" class="form-control" id="quantity_received" name="quantity_received"
                            min="0" aria-required="true" placeholder="Enter the quantity of product received">
                        <span id="quanRecievedError" class="text-danger"
                            style="display: none; font-size: 0.9em;">Quantity
                            Received is required</span>
                    </div>

                    <!-- Quantity Defective -->
                    <div class="col-12 col-md-6 mb-3">
                        <label for="quantity_defective" class="form-label">Quantity Defective*</label>
                        <input type="number" class="form-control" id="quantity_defective" name="quantity_defective"
                            min="0" aria-required="true" placeholder="Enter the amount of defects ">
                        <span id="quanDefectiveError" class="text-danger"
                            style="display: none; font-size: 0.9em;">Quantity
                            Defective is required</span>
                    </div>
                </div>




                <div class="row">
                    <!-- Quality Representative's Name -->
                    <div class="col-12 col-md-4 mb-5">
                        <label for="quality_rep_name" class="form-label">Quality Representative's Name*</label>
                        <input type="text" class="form-control" id="quality_rep_name" name="quality_rep_name"
                            aria-required="true" placeholder="Enter quality representative's name">
                        <span id="qualityError" class="text-danger" style="display: none; font-size: 0.9em;">Quality
                            Representative's
                            name is required</span>
                    </div>

                    <!-- Item marked Nonconforming -->
                    <div class="col-12 col-md-4 mb-3 hh">
                        <fieldset>
                            <legend class="form-label fw-bold">Item marked Nonconforming:*</legend>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" id="nonconforming_yes" name="nonconforming"
                                    value="Yes" aria-required="true">
                                <label class="form-check-label" for="nonconforming_yes">Yes</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" id="nonconforming_no" name="nonconforming"
                                    value="No" aria-required="true">
                                <label class="form-check-label" for="nonconforming_no">No</label>
                            </div>
                            <span id="itemMarkError" class="text-danger" style="display: none; font-size: 0.9em;">Please
                                pick one of the radio buttons</span>

                        </fieldset>
                    </div>
                    <div class="col-12 col-md-4 mb-3">
                        <fieldset>
                            <legend class="form-label fw-bold">Engineering Not Needed:*</legend>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" id="enginnotneeded_yes" name="ennotneeded"
                                    value="Yes" aria-required="true">
                                <label class="form-check-label" for="enginnotneeded_yes">Yes</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" id="enginnotneeded_no" name="ennotneeded"
                                    value="No" aria-required="true">
                                <label class="form-check-label" for="enginnotneeded_no">No</label>
                            </div>
                            <span id="enginNotMarkedError" class="text-danger"
                                style="display: none; font-size: 0.9em;">Please pick one of the radio buttons</span>
                        </fieldset>
                    </div>
                </div>
                <div>
                    <button type="submit" class="btnSub" id="btnSubmit">Submit</button>
                    <button type="submit" class="btnSub" id="btnSave">Save</button>
                </div>
            </form>

            <div id="supplierModal" class="modal" style="display: none;">
                <div class="modal-content">
                    <span class="close">&times;</span>
                    <h2>Add Supplier</h2>
                    <form id="supplierForm">
                        <label for="supplierName">Supplier Name:</label>
                        <input type="text" id="supplierName" name="supplierName" class="form-control">
                        <button type="submit" class="btnSub">Add</button>
                    </form>
                </div>
            </div>

        </main>
    </div>
    <footer>
        <div class="footer-links">
            <a href="index.html">Dashboard</a>
            <a href="ncrlog.html">NCR LOG</a>
            <a href="create.html">Create NCR</a>
        </div>
        <p>&copy; 2024 . All rights reserved.</p>
    </footer>

    <script src="scripts/script.js"></script>
    <script src="scripts/inspect.js"></script>
    <script src="scripts/dataload.js"></script>
    <script src="scripts/users.js"></script>

    <script src="scripts/supplier.js"></script>

    <script>
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
        });
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            function generateNcrNumber() {
                const year = new Date().getFullYear();
                const randomNum = Math.floor(Math.random() * 1000);
                const paddedNumber = randomNum.toString().padStart(3, '0');

                const ncrNumber = `${year}-${paddedNumber}`;
                return ncrNumber;
            }

            const ncrInput = document.getElementById("ncr_no");
            if (ncrInput) {
                ncrInput.value = generateNcrNumber();
                //changes the ncr no textbox to read able only
                ncrInput.setAttribute("disabled", true);
            }
        });
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const today = new Date();
            const formattedDate = today.toISOString().split('T')[0];
            document.getElementById("date").value = formattedDate;
        });
    </script>


    <script>
        const openModalBtn = document.getElementById("openModalBtn");
        const supplierModal = document.getElementById("supplierModal");
        const closeModalBtn = supplierModal.querySelector(".close");
        const supplierForm = document.getElementById("supplierForm");
        const supplierNameInput = document.getElementById("supplierName");
        const supplierDropdown = document.getElementById("supplier_name");

        openModalBtn.addEventListener("click", (event) => {
            event.preventDefault();
            supplierModal.style.display = "block";
        });

        closeModalBtn.addEventListener("click", () => {
            supplierModal.style.display = "none";
        });

        window.addEventListener("click", (event) => {
            if (event.target === supplierModal) {
                supplierModal.style.display = "none";
            }
        });

        // Handle the supplier form submission
        supplierForm.addEventListener("submit", (event) => {
            event.preventDefault(); 

            const newSupplierName = supplierNameInput.value.trim();
            if (newSupplierName) {
                // Add the new supplier to the dropdown
                const newOption = document.createElement("option");
                newOption.value = newSupplierName.toLowerCase().replace(/ /g, "_");
                newOption.textContent = newSupplierName;

                supplierDropdown.appendChild(newOption);

                supplierNameInput.value = "";
                supplierModal.style.display = "none";

                alert("New supplier added successfully!");
            } else {
                alert("Please enter a supplier name.");
            }
        });
    </script>





    <!-- Bootstrap JS and dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
        integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
        crossorigin="anonymous"></script>
</body>

</html>